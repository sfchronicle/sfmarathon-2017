<!doctype html>
<html>
  <head>
    <title><%= json.project.seo_title %></title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="__sync_contentCategory" content="meterA">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="../style.css">

    <%= !json.project.embedded ? t.include("partials/_paywall.html") : t.include("partials/_embedframe.html") %>

    <%= t.include("partials/_head.html") %>

  </head>

  <%= !json.project.embedded ? "<body>" : "<body is='responsive-body'>" %>

    <%= t.include("partials/_flat_nav.html") %>
    <%= t.include("partials/_nav.html") %>

    <div class="outer" id="content">

      <div class="top-container">
        <div class="title"><%=json.sfmarathonrace["Title"]%></div>
        <div class="title-deck"><%=json.sfmarathonrace["Deck"]%></div>
        <div class="author">By <a href="mailto:eallday@sfchronicle.com">Erin Allday</a> and <a href="mailto:eoneill@sfchronicle.com">Emma O'Neill</a>
          <div>Photos by <a href="mailto:smejia@sfchronicle.com">Santiago Mejia</a></div>
        </div>
      </div>

      <div class="intro-text">
        <% json.sfmarathonrace.intro.forEach(function(d,idx) { %>
            <p><%=d.value%></p>
        <% }); %>
      </div>

      <!-- <div class="link-wrapper" id="link-nav">
        <% json.sfmarathontraining.profiles.forEach(function(d,idx){ %>
          <% if (d.Key == "hilary"){ %>
            <div class="profile-link"><a href="#profile<%=d.Key%>">Hilary & Gene</a></div>
          <% } else { %>
            <div class="profile-link"><a href="#profile<%=d.Key%>"><%=d.Name.split(" ")[0]%></a></div>
          <% } %>
        <% }); %>
      </div> -->

      <% json.sfmarathonrace.profiles.forEach(function(d,idx){ %>

        <div class="profile-hed <%=d.Key%>"  id="profile<%=d.Key%>"><%=d.Name%></div>

        <div class="inline-image">
          <img src="http://ww2.hdnux.com/photos/61/64/55/<%= d.image[0].WcmID %>/5/1000x0.jpg">
          <div class="caption"><%= d.image.Caption %></div>
        </div>

        <div class="interactive-container">
          <% if (d.Key == "hilary"){ %>
            <div class="hed">Hilary and Gene's races</div>
          <% } else { %>
            <div class="hed"><%=d.Name.split(" ")[0]%>'s race</div>
          <% } %>
          <div class="interactive-deck"><%=d["Race-deck"]%></div>
          <div class="race-chart">
            <div class="hover-container races">
              <div id="hover-race-name-<%=d.Key%>" class="hover-name"></div>
              <div id="hover-race-pace-<%=d.Key%>" class="hover-pace"></div>
            </div>
            <div id="<%=d.Key%>-race"></div>
          </div>
          <div class="source nomargin">Source: <a href="https://www.strava.com" target="_blank">Strava</a>, <%=d.Name%>, <a href="http://www.thesfmarathon.com/" target="_blank">SF Marathon</a></div>
        </div>

        <% if (d.Key == "hilary"){ %>

          <div class="text-pullout padded">Hilary wanted to run a time of <span class="bold-text-pullout"><%=d["Finish-goal"]%></span>
          <div>and succeeded in running <span class="bold-text-pullout"><%=d["Finish-time"]%></span></div>
          <div>Gene ran a time of <span class="bold-text-pullout"><%=d["Finish-time-Gene"]%></div>
          </div>

        <% } else { %>

          <div class="text-pullout padded"><%=d.Name.split(" ")[0]%> wanted to run a time of <span class="bold-text-pullout"><%=d["Finish-goal"]%></span>
          <div>and succeeded in running <span class="bold-text-pullout"><%=d["Finish-time"]%></span></div>
          </div>

        <% } %>

        <% d.text.forEach(function(d,idx) { %>
            <p><%=d.value%></p>
        <% }); %>


      <% }); %>

      <div class="section-break"></div>

      <div class="conclusion-text">
        <% json.sfmarathonrace.conclusion.forEach(function(d,idx) { %>
          <% if (d.type == "text") { %>
            <p><%=d.value%></p>
          <% } else { %>
            <div class="interactive-container">
              <div class="hed"><%=d.value[0].Hed%></div>
              <div class="interactive-deck"><%=d.value[0].Deck%></div>
              <div class="legend-container-big">
                <div class="button all active" id="all-button">All runners</div>
                <% json.sfmarathontraining.profiles.forEach(function(d,idx){ %>
                  <% if (d.Key == "hilary"){ %>
                    <div class="button hilary" id="hilary-button">Hilary Shirazi</div>
                    <div class="button gene" id="gene-button">Gene Dykes</div>
                  <% } else { %>
                    <div class="button <%=d.Key%>" id="<%=d.Key%>-button"><%=d.Name%></div>
                  <% } %>
                <% }); %>
              </div>
              <div id="dot-chart-races"></div>
              <div class="source">Source: <a href="https://www.strava.com" target="_blank">Strava</a>, Bálint Gál, Gene Dykes, Greg McQuaid, Hilary Shirazi, Iain Mickle, Jorge Maravilla, Lauren Elkins</div>
            </div>
          <% } %>
        <% }); %>
      </div>

    </div>

    <%= t.include("partials/_credits.html") %>
    <%= t.include("partials/_dontMiss_race.html") %>
    <%= t.include("partials/_footer.html") %>

    <script>
      var balintData = <%= JSON.stringify(json.BalintGal) %>;
      var geneData = <%= JSON.stringify(json.GeneDykes) %>;
      var gregData = <%= JSON.stringify(json.GregMcQuaid) %>;
      var hilaryData = <%= JSON.stringify(json.HilaryDykes) %>;
      var iainData = <%= JSON.stringify(json.IainMickle) %>;
      var jorgeData = <%= JSON.stringify(json.JorgeMaravilla) %>;
      var laurenData = <%= JSON.stringify(json.LaurenElkins) %>;

      var raceData = <%= JSON.stringify(csv.allStravaSplits) %>;
      var elevationData = <%= JSON.stringify(csv.elevationProfile) %>;
    </script>

    <script src="../app-races.js" async></script>

    <%= t.include("partials/_helloSFC.html") %>

  </body>
</html>
